================================================================================
RUN STORED-PROCEDURE basic
================================================================================

RUN STORED-PROCEDURE sp_GetCustomers.
RUN STORED-PROCEDURE "sp_Update".

--------------------------------------------------------------------------------

(source_code
  (run_stored_procedure_statement
    procedure: (identifier))
  (run_stored_procedure_statement
    procedure: (string_literal)))

================================================================================
RUN STORED-PROCEDURE with handle
================================================================================

RUN STORED-PROCEDURE sp_Query hProc = PROC-HANDLE.

--------------------------------------------------------------------------------

(source_code
  (run_stored_procedure_statement
    procedure: (identifier)
    handle_var: (identifier)))

================================================================================
RUN STORED-PROCEDURE with LOAD-RESULT-INTO
================================================================================

RUN STORED-PROCEDURE sp_GetData LOAD-RESULT-INTO hResult.
RUN STORED-PROCEDURE sp_Query LOAD-RESULT-INTO hResult iStatus = PROC-STATUS.

--------------------------------------------------------------------------------

(source_code
  (run_stored_procedure_statement
    procedure: (identifier)
    result_handle: (identifier))
  (run_stored_procedure_statement
    procedure: (identifier)
    result_handle: (identifier)
    status_var: (identifier)))

================================================================================
RUN STORED-PROCEDURE with parameters
================================================================================

RUN STORED-PROCEDURE sp_Insert (INPUT "John", INPUT 25).
RUN STORED-PROCEDURE sp_Update (PARAM custId = iCustId, OUTPUT cResult).
RUN STORED-PROCEDURE sp_Query NO-ERROR (1, 2, 3).

--------------------------------------------------------------------------------

(source_code
  (run_stored_procedure_statement
    procedure: (identifier)
    (parameter_list
      value: (string_literal)
      value: (number_literal)))
  (run_stored_procedure_statement
    procedure: (identifier)
    (parameter_list
      name: (identifier)
      value: (identifier)
      value: (identifier)))
  (run_stored_procedure_statement
    procedure: (identifier)
    (parameter_list
      value: (number_literal)
      value: (number_literal)
      value: (number_literal))))

================================================================================
RUN STORED-PROCEDURE - reference snippets
================================================================================

DEFINE VARIABLE intvar AS INTEGER NO-UNDO.
RUN STORED-PROCEDURE pcust intvar = PROC-HANDLE NO-ERROR
(10, OUTPUT 0, OUTPUT 0).
FOR EACH proc-text-buffer WHERE PROC-HANDLE = intvar:
DISPLAY proc-text-buffer.
END.
IF ERROR-STATUS:ERROR THEN
MESSAGE "Stored Procedure failed to run".
ELSE
CLOSE STORED-PROCEDURE pcust WHERE PROC-HANDLE = intvar.

DEFINE VAR handle1 AS INTEGER.
RUN STORED-PROCEDURE send-sql-statement handle1 = PROC-HANDLE
("SELECT name, cust_num FROM customer").
FOR EACH proc-text-buffer WHERE PROC-HANDLE = handle1:
DISPLAY proc-text.
END.
CLOSE STORED-PROCEDURE send-sql-statement WHERE PROC-HANDLE = handle1.

DEFINE VAR h1 AS INTEGER NO-UNDO.
DEFINE VAR jx AS INTEGER NO-UNDO.
RUN STORED-PROCEDURE send-sql-statement h1 = PROC-HANDLE NO-ERROR
("select count (*) from xxx.customer where name between 'A' and 'Z' ").
IF ERROR-STATUS:ERROR THEN
DO jx = 1 TO ERROR-STATUS:NUM-MESSAGES:
MESSAGE "error" ERROR-STATUS:GET-NUMBER(jx)
ERROR-STATUS:GET-MESSAGE(jx).
END.
CLOSE STORED-PROCEDURE send-sql-statement WHERE PROC-HANDLE = h1.

DEFINE VARIABLE res AS INTEGER NO-UNDO INITIAL 0.
DEFINE VARIABLE tthndl AS HANDLE.
CREATE TEMP-TABLE tthndl.
RUN STORED-PROCEDURE send-sql-statement LOAD-RESULT-INTO tthndl
res = PROC-STATUS ("SELECT * FROM customer").
IF (res = 1) THEN
DISPLAY "Succeeded".

--------------------------------------------------------------------------------

(source_code
  (variable_definition
    name: (identifier)
    type: (identifier)
    (no_undo))
  (run_stored_procedure_statement
    procedure: (identifier)
    handle_var: (identifier)
    (parameter_list
      value: (number_literal)
      value: (number_literal)
      value: (number_literal)))
  (for_each_statement
    (record
      table: (identifier)
      (where_phrase
        (binary_expression
          (identifier)
          (identifier))))
    (body
      (display_statement
        (identifier))))
  (if_statement
    (object_access
      left: (identifier)
      right: (identifier))
    then: (message_statement
      (string_literal))
    else: (close_stored_procedure_statement
      procedure: (identifier)
      handle: (identifier)))
  (variable_definition
    name: (identifier)
    type: (identifier))
  (run_stored_procedure_statement
    procedure: (identifier)
    handle_var: (identifier)
    (parameter_list
      value: (string_literal)))
  (for_each_statement
    (record
      table: (identifier)
      (where_phrase
        (binary_expression
          (identifier)
          (identifier))))
    (body
      (display_statement
        (identifier))))
  (close_stored_procedure_statement
    procedure: (identifier)
    handle: (identifier))
  (variable_definition
    name: (identifier)
    type: (identifier)
    (no_undo))
  (variable_definition
    name: (identifier)
    type: (identifier)
    (no_undo))
  (run_stored_procedure_statement
    procedure: (identifier)
    handle_var: (identifier)
    (parameter_list
      value: (string_literal)))
  (if_statement
    (object_access
      left: (identifier)
      right: (identifier))
    then: (do_block
      variable: (identifier)
      start: (number_literal)
      end: (object_access
        left: (identifier)
        right: (identifier))
      (body
        (message_statement
          (string_literal)
          (function_call
            function: (object_access
              left: (identifier)
              right: (identifier))
            (arguments
              (argument
                value: (identifier))))
          (function_call
            function: (object_access
              left: (identifier)
              right: (identifier))
            (arguments
              (argument
                value: (identifier))))))))
  (close_stored_procedure_statement
    procedure: (identifier)
    handle: (identifier))
  (variable_definition
    name: (identifier)
    type: (identifier)
    (no_undo)
    (initial_option
      value: (number_literal)))
  (variable_definition
    name: (identifier)
    type: (identifier))
  (create_statement
    table: (identifier)
    (identifier))
  (run_stored_procedure_statement
    procedure: (identifier)
    result_handle: (identifier)
    status_var: (identifier)
    (parameter_list
      value: (string_literal))
    (if_statement
      (parenthesized_expression
        (binary_expression
          (identifier)
          (number_literal)))
      then: (display_statement
        (string_literal)))
