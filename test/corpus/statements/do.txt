================================================================================
DO block basic
================================================================================

DO:
  x = 1.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (number_literal)))))

================================================================================
DO with loop variable
================================================================================

DO idx = 1 TO 3:
  x = idx.
END.

DO i = 1 TO 10 BY 2:
  DISPLAY i.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    variable: (identifier)
    start: (number_literal)
    end: (number_literal)
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (identifier))))
  (do_block
    variable: (identifier)
    start: (number_literal)
    end: (number_literal)
    step: (number_literal)
    (body
      (display_statement
        record: (identifier)))))

================================================================================
DO WHILE
================================================================================

DO WHILE idx < 3:
  idx = idx + 1.
END.

DO WHILE NOT eof:
  x = 1.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (binary_expression
      (identifier)
      (number_literal))
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (binary_expression
          (identifier)
          (number_literal)))))
  (do_block
    (unary_expression
      (identifier))
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (number_literal)))))

================================================================================
DO WHILE with ON ERROR UNDO THROW
================================================================================

DO WHILE idx < 3 ON ERROR UNDO, THROW:
  idx = idx + 1.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (binary_expression
      (identifier)
      (number_literal))
    (on_error_phrase)
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (binary_expression
          (identifier)
          (number_literal))))))

================================================================================
DO with ON ERROR UNDO LEAVE
================================================================================

DO ON ERROR UNDO, LEAVE:
  idx = 1.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (on_error_phrase)
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (number_literal)))))

================================================================================
DO with ON STOP UNDO NEXT
================================================================================

DO ON STOP UNDO, NEXT:
  idx = 3.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (on_stop_phrase)
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (number_literal)))))

================================================================================
DO with ON QUIT LEAVE
================================================================================

DO ON QUIT, LEAVE:
  idx = 2.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (on_quit_phrase)
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (number_literal)))))

================================================================================
DO TRANSACTION
================================================================================

DO TRANSACTION:
END.

DO TRANSACTION:
  CREATE Customer.
  Customer.Name = "Test".
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (body))
  (do_block
    (body
      (create_statement
        table: (identifier))
      (assignment_statement
        left: (qualified_name
          left: (identifier)
          right: (identifier))
        operator: (assignment_operator)
        right: (string_literal)))))

================================================================================
DO TRANSACTION WHILE
================================================================================

DO TRANSACTION WHILE something:get-next():
  something:buffer-copy(something).
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (function_call
      function: (object_access
        left: (identifier)
        right: (identifier))
      (arguments))
    (body
      (expression_statement
        (function_call
          function: (object_access
            left: (identifier)
            right: (identifier))
          (arguments
            (argument
              name: (identifier))))))))

================================================================================
DO WHILE with ON ENDKEY UNDO RETRY
================================================================================

DO WHILE TRUE ON ENDKEY UNDO, RETRY:
  MESSAGE "hi".
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (boolean_literal)
    (on_endkey_phrase)
    (body
      (message_statement
        (string_literal)))))

================================================================================
DO ON ENDKEY UNDO RETURN NO-APPLY
================================================================================

DO ON ENDKEY UNDO, RETURN NO-APPLY:
  MESSAGE "x".
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (on_endkey_phrase)
    (body
      (message_statement
        (string_literal)))))

================================================================================
DO with label
================================================================================

process_block: DO:
  x = 1.
END.

outer: DO i = 1 TO 10:
  inner: DO j = 1 TO 5:
    DISPLAY i j.
  END.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    label: (identifier)
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (number_literal))))
  (do_block
    label: (identifier)
    variable: (identifier)
    start: (number_literal)
    end: (number_literal)
    (body
      (do_block
        label: (identifier)
        variable: (identifier)
        start: (number_literal)
        end: (number_literal)
        (body
          (display_statement
            (field
              field: (identifier))
            (field
              field: (identifier))))))))

================================================================================
DO with ON ENDKEY UNDO LEAVE with label
================================================================================

myloop: DO WHILE TRUE ON ENDKEY UNDO myloop, LEAVE myloop:
  x = x + 1.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    label: (identifier)
    (boolean_literal)
    (on_endkey_phrase
      undo_label: (identifier)
      leave_label: (identifier))
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (binary_expression
          (identifier)
          (number_literal))))))

================================================================================
DO with expression TO expression
================================================================================

DO i = startVal TO endVal:
  DISPLAY i.
END.

DO i = getStart() TO getEnd() BY getStep():
  DISPLAY i.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    variable: (identifier)
    start: (identifier)
    end: (identifier)
    (body
      (display_statement
        record: (identifier))))
  (do_block
    variable: (identifier)
    start: (function_call
      function: (identifier)
      (arguments))
    end: (function_call
      function: (identifier)
      (arguments))
    step: (function_call
      function: (identifier)
      (arguments))
    (body
      (display_statement
        record: (identifier)))))

================================================================================
DO with empty body using dot terminator
================================================================================

DO.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (body)))

================================================================================
DO FOR with TRANSACTION STOP-AFTER and ON ERROR
================================================================================

DO FOR some_copy TRANSACTION STOP-AFTER 2 ON ERROR UNDO, THROW:
  a = 5.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (for_phrase
      record: (identifier))
    (stop_after_phrase
      time: (number_literal))
    (on_error_phrase)
    (body
      (assignment_statement
        left: (identifier)
        operator: (assignment_operator)
        right: (number_literal)))))

================================================================================
DO FOR with QUERY-TUNING and FRAME options
================================================================================

DO FOR rec1, rec2 QUERY-TUNING (LOOKAHEAD NO-LOOKAHEAD CACHE-SIZE 10 INDEX-HINT NO-INDEX-HINT SEPARATE-CONNECTION NO-SEPARATE-CONNECTION DEBUG SQL NO-DEBUG JOIN-BY-SQLDB NO-JOIN-BY-SQLDB BIND-WHERE NO-BIND-WHERE) WITH WIDTH 40:
  DISPLAY rec1.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (for_phrase
      record: (identifier)
      record: (identifier))
    (query_tuning
      (number_literal))
    (frame_phrase
      width: (number_literal))
    (body
      (display_statement
        record: (identifier)))))

================================================================================
DO PRESELECT
================================================================================

DO PRESELECT EACH Customer NO-LOCK:
  DISPLAY Customer.Name.
END.

--------------------------------------------------------------------------------

(source_code
  (do_block
    (preselect_phrase
      (preselect_record_list
        (preselect_record
          table: (identifier)
          (no_lock))))
    (body
      (display_statement
        record: (qualified_name
          left: (identifier)
          right: (identifier))))))

================================================================================
DO - Reference snippet
================================================================================

FOR EACH Customer NO-LOCK:
  DISPLAY Customer.Name Customer.CreditLimit.
  PAUSE 3.
  IF Customer.CreditLimit > 80000 THEN DO:
    Customer.CreditLimit = 80000.
    DISPLAY Customer.Name Customer.CreditLimit.
  END.
END.

--------------------------------------------------------------------------------

(source_code
  (for_statement
    (record
      (identifier)
      (no_lock))
    (body
      (display_statement
        (field
          (qualified_name
            (identifier)
            (identifier)))
        (field
          (qualified_name
            (identifier)
            (identifier))))
      (pause_statement
        (number_literal))
      (if_statement
        (binary_expression
          (qualified_name
            (identifier)
            (identifier))
          (number_literal))
        (do_block
          (body
            (assignment_statement
              (qualified_name
                (identifier)
                (identifier))
              (assignment_operator)
              (number_literal))
            (display_statement
              (field
                (qualified_name
                  (identifier)
                  (identifier)))
              (field
                (qualified_name
                  (identifier)
                  (identifier))))))))))
